{% extends "base.html" %}
{% block content %}
<div class="card">
  <div style="display:flex; justify-content:space-between; align-items:center;">
    <h2 style="color:#005826; margin:0;">ğŸ›¡ï¸ å­¦ç”Ÿä¿¡ç”¨ç®¡ç†</h2>
    
    <form method="get" style="display:flex; gap:10px;">
        <input name="filter_score" type="number" placeholder="è¾“å…¥åˆ†æ•°ç­›é€‰ (å¦‚: 6)" value="{{ current_filter or '' }}" 
               style="padding:8px; border:1px solid #ccc; border-radius:4px;">
        <button type="submit" class="btn">ç­›é€‰ â‰¤ æ­¤åˆ†æ•°çš„å­¦ç”Ÿ</button>
        {% if current_filter %}
        <a href="{{ url_for('admin_credit') }}" class="btn btn-outline">é‡ç½®</a>
        {% endif %}
    </form>
  </div>
  
  <p class="muted">å…±æ‰¾åˆ° {{ users|length }} åå­¦ç”Ÿ</p>

  <table class="modern-table">
    <thead>
      <tr>
        <th>å­¦å·</th>
        <th>å§“å</th>
        <th>ä¿¡ç”¨åˆ†</th>
        <th>è´¦å·çŠ¶æ€</th>
        <th width="280">æ‰‹åŠ¨æ‰£åˆ†æ“ä½œ</th>
      </tr>
    </thead>
    <tbody>
      {% for u in users %}
      <tr>
        <td>{{ u['å­¦å·æˆ–å·¥å·'] }}</td>
        <td><strong>{{ u['å§“å'] }}</strong></td>
        <td>
            {% if u['ä¿¡ç”¨åˆ†'] >= 8 %}<span style="color:#166534; font-weight:bold; font-size:16px;">{{ u['ä¿¡ç”¨åˆ†'] }}</span>
            {% elif u['ä¿¡ç”¨åˆ†'] >= 6 %}<span style="color:#ca8a04; font-weight:bold; font-size:16px;">{{ u['ä¿¡ç”¨åˆ†'] }}</span>
            {% else %}<span style="color:#dc2626; font-weight:bold; font-size:16px;">{{ u['ä¿¡ç”¨åˆ†'] }} (ä½)</span>{% endif %}
        </td>
        <td>
            {% if u['è´¦å·çŠ¶æ€']=='æ­£å¸¸' %}<span class="badge badge-green">æ­£å¸¸</span>
            {% else %}<span class="badge badge-red">{{ u['è´¦å·çŠ¶æ€'] }}</span>{% endif %}
        </td>
        <td>
            <form action="{{ url_for('admin_credit') }}" method="post" style="display: flex; gap: 5px; align-items: center; margin: 0;">
                <input type="hidden" name="user_id" value="{{ u['ç”¨æˆ·ID'] }}">
                <input name="points" type="number" placeholder="åˆ†å€¼" required style="width: 50px; padding: 4px; border: 1px solid #ddd; border-radius: 4px;">
                <input name="reason" type="text" placeholder="åŸå› " required style="width: 100px; padding: 4px; border: 1px solid #ddd; border-radius: 4px;">
                <button type="submit" class="btn btn-sm" style="background: #dc2626; padding: 4px 8px;">æ‰§è¡Œ</button>
            </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}